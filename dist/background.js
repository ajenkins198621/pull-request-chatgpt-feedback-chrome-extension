chrome.runtime.onMessage.addListener(((e,t,a)=>{if("fetchDataFromNewTab"===e.action){const t=e.url;return chrome.tabs.create({url:t},(e=>{const t=(r,s)=>{"fetchedData"===r.action&&(a({success:!0,data:r.data}),chrome.tabs.remove(e.id),chrome.runtime.onMessage.removeListener(t))};chrome.runtime.onMessage.addListener(t)})),!0}if("fetchDataFromChatGPTApi"===e.action)return fetch("http://localhost:4175/api/analyze-code-diff",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({diff:e.diff})}).then((e=>e.json())).then((e=>{a({success:!0,data:e})})).catch((e=>{a({success:!1,error:e})})),!0})),chrome.tabs.onUpdated.addListener(((e,t,a)=>{t.url&&chrome.tabs.sendMessage(e,{action:"urlChanged",newUrl:t.url})}));